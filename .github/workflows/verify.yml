name: 'Verify'

on:
    push:
    pull_request:
        branches:
            - '*'

jobs:
    build-and-verify:
        runs-on: 'ubuntu-latest'
        steps:
            - uses: actions/checkout@v2
            - name: 'Set up JDK 8'
              uses: actions/setup-java@v2
              with:
                  distribution: 'adopt'
                  java-version: 8
            - name: Prepare JDK8 env var
              shell: bash
              run: echo "JDK8=$JAVA_HOME" >> $GITHUB_ENV

            - name: 'Set up JDK 11'
              uses: actions/setup-java@v2
              with:
                  distribution: 'adopt'
                  java-version: 11
            - name: Prepare JDK11 env var
              shell: bash
              run: echo "JDK11=$JAVA_HOME" >> $GITHUB_ENV

            - name: 'Set up JDK 17'
              uses: actions/setup-java@v2
              with:
                  distribution: 'adopt'
                  java-version: 17
            - name: Prepare JDK17 env var
              shell: bash
              run: echo "JDK17=$JAVA_HOME" >> $GITHUB_ENV

            - name: 'Build Cucumber-Companion'
              uses: gradle/gradle-build-action@v2
              with:
                  arguments: "functionalTest"
