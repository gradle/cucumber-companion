/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package org.gradle.cucumber.companion

import org.gradle.testkit.runner.GradleRunner
import spock.lang.Specification
import spock.lang.TempDir

import java.nio.file.Path

class CucumberCompanionPluginFunctionalTest extends Specification {

    @TempDir
    Path projectDir
    def buildFile
    def settingsFile

    def setup() {
        buildFile = projectDir.resolve("build.gradle")
        settingsFile = projectDir.resolve("settings.gradle")
    }

    def "can run task"() {
        given:
        settingsFile.text = ""
        buildFile.text = """\
            plugins {
                id('org.gradle.cucumber.companion.greeting')
            }
            """.stripIndent(true)

        and:
        def runner = GradleRunner.create()
            .forwardOutput()
            .withPluginClasspath()
            .withArguments("greeting")
            .withProjectDir(projectDir.toFile())

        when:
        def result = runner.build()

        then:
        result.output.contains("Hello from plugin 'org.gradle.cucumber.companion.greeting'")
    }
}
